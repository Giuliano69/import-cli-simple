<?xml version="1.0" encoding="UTF-8" ?>
<container xmlns="http://symfony.com/schema/dic/services"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://symfony.com/schema/dic/services http://symfony.com/schema/dic/services/services-1.0.xsd">
    
    <parameters>
        <parameter key="utility.class.name">TechDivision\Import\Utils\SqlStatements</parameter>
        <parameter key="application.name">M2IF - Simple Console Tool</parameter>
        <parameter key="application.version">1.0.0-alpha59</parameter>
    </parameters>

    <services>

        <service id="command.import.products" class="TechDivision\Import\Cli\Command\ImportProductsCommand"/>
        <service id="command.import.categories" class="TechDivision\Import\Cli\Command\ImportCategoriesCommand"/>
        <service id="command.import.clear.pid" class="TechDivision\Import\Cli\Command\ImportClearPidCommand"/>

        <service id="generator.core.config.data.uid" class="TechDivision\Import\Utils\Generators\CoreConfigDataUidGenerator"/>

        <service id="repository.category" class="TechDivision\Import\Repositories\CategoryRepository">
            <argument type="service" id="connection"/>
            <argument>%utility.class.name%</argument>
        </service>
        <service id="repository.category.varchar" class="TechDivision\Import\Repositories\CategoryVarcharRepository">
            <argument type="service" id="connection"/>
            <argument>%utility.class.name%</argument>
        </service>
        <service id="repository.eav.attribute" class="TechDivision\Import\Repositories\EavAttributeRepository">
            <argument type="service" id="connection"/>
            <argument>%utility.class.name%</argument>
        </service>
        <service id="repository.eav.attribute.set" class="TechDivision\Import\Repositories\EavAttributeSetRepository">
            <argument type="service" id="connection"/>
            <argument>%utility.class.name%</argument>
        </service>
        <service id="repository.eav.entity.type" class="TechDivision\Import\Repositories\EavEntityTypeRepository">
            <argument type="service" id="connection"/>
            <argument>%utility.class.name%</argument>
        </service>
        <service id="repository.store" class="TechDivision\Import\Repositories\StoreRepository">
            <argument type="service" id="connection"/>
            <argument>%utility.class.name%</argument>
        </service>
        <service id="repository.store.website" class="TechDivision\Import\Repositories\StoreWebsiteRepository">
            <argument type="service" id="connection"/>
            <argument>%utility.class.name%</argument>
        </service>
        <service id="repository.tax.class" class="TechDivision\Import\Repositories\TaxClassRepository">
            <argument type="service" id="connection"/>
            <argument>%utility.class.name%</argument>
        </service>
        <service id="repository.link.type" class="TechDivision\Import\Repositories\LinkTypeRepository">
            <argument type="service" id="connection"/>
            <argument>%utility.class.name%</argument>
        </service>
        <service id="repository.link.attribute" class="TechDivision\Import\Repositories\LinkAttributeRepository">
            <argument type="service" id="connection"/>
            <argument>%utility.class.name%</argument>
        </service>
        <service id="repository.core.config.data" class="TechDivision\Import\Repositories\CoreConfigDataRepository">
            <argument type="service" id="generator.core.config.data.uid"/>
            <argument type="service" id="connection"/>
            <argument>%utility.class.name%</argument>
        </service>

        <service id="assembler.category" class="TechDivision\Import\Assembler\CategoryAssembler">
            <argument type="service" id="repository.category"/>
            <argument type="service" id="repository.category.varchar"/>
        </service>

        <service id="registry.processor" class="TechDivision\Import\Services\RegistryProcessor"/>

        <service id="import.processor" class="TechDivision\Import\Services\ImportProcessor">
            <argument type="service" id="connection"/>
            <argument type="service" id="assembler.category"/>
            <argument type="service" id="repository.category"/>
            <argument type="service" id="repository.category.varchar"/>
            <argument type="service" id="repository.eav.attribute"/>
            <argument type="service" id="repository.eav.attribute.set"/>
            <argument type="service" id="repository.eav.entity.type"/>
            <argument type="service" id="repository.store"/>
            <argument type="service" id="repository.store.website"/>
            <argument type="service" id="repository.tax.class"/>
            <argument type="service" id="repository.link.type"/>
            <argument type="service" id="repository.link.attribute"/>
            <argument type="service" id="repository.core.config.data"/>
        </service>

        <service id="processor.category.bunch" class="TechDivision\Import\Category\Services\CategoryBunchProcessor">
            <argument type="service" id="connection"/>
            <argument type="service" id="repository.category"/>
            <argument type="service" id="repository.category.datetime"/>
            <argument type="service" id="repository.category.decimal"/>
            <argument type="service" id="repository.category.int"/>
            <argument type="service" id="repository.category.text"/>
            <argument type="service" id="repository.category.varchar"/>
            <argument type="service" id="repository.eav.attribute"/>
            <argument type="service" id="repository.url.rewrite"/>
            <argument type="service" id="action.category.datetime"/>
            <argument type="service" id="action.category.decimal"/>
            <argument type="service" id="action.category.int"/>
            <argument type="service" id="action.category"/>
            <argument type="service" id="action.category.text"/>
            <argument type="service" id="action.category.varchar"/>
            <argument type="service" id="action.url.rewrite"/>
            <argument type="service" id="assembler.category"/>
        </service>

        <service id="processor.product.bunch" class="TechDivision\Import\Product\Services\ProductBunchProcessor">
            <argument type="service" id="connection"/>
            <argument type="service" id="repository.product"/>
            <argument type="service" id="repository.product.website"/>
            <argument type="service" id="repository.product.datetime"/>
            <argument type="service" id="repository.product.decimal"/>
            <argument type="service" id="repository.product.int"/>
            <argument type="service" id="repository.product.text"/>
            <argument type="service" id="repository.product.varchar"/>
            <argument type="service" id="repository.category.product"/>
            <argument type="service" id="repository.stock.status"/>
            <argument type="service" id="repository.stock.item"/>
            <argument type="service" id="repository.url.rewrite"/>
            <argument type="service" id="repository.url.rewrite.product.category"/>
            <argument type="service" id="repository.eav.attribute.option.value"/>
            <argument type="service" id="repository.eav.attribute"/>
            <argument type="service" id="action.category.product"/>
            <argument type="service" id="action.product.datetime"/>
            <argument type="service" id="action.product.decimal"/>
            <argument type="service" id="action.product.int"/>
            <argument type="service" id="action.product"/>
            <argument type="service" id="action.product.text"/>
            <argument type="service" id="action.product.varchar"/>
            <argument type="service" id="action.product.website"/>
            <argument type="service" id="action.stock.item"/>
            <argument type="service" id="action.stock.status"/>
            <argument type="service" id="action.url.rewrite"/>
            <argument type="service" id="action.url.rewrite.product.category"/>
        </service>

        <service id="processor.product.bundle" class="TechDivision\Import\Product\Services\ProductBundleProcessor">
            <argument type="service" id="connection"/>
            <argument type="service" id="repository.bundle.option"/>
            <argument type="service" id="repository.bundle.option.value"/>
            <argument type="service" id="repository.bundle.selection"/>
            <argument type="service" id="repository.bundle.selection.price"/>
            <argument type="service" id="action.product.bundle.option"/>
            <argument type="service" id="action.product.bundle.option.value"/>
            <argument type="service" id="action.product.bundle.selection"/>
            <argument type="service" id="action.product.bundle.selection.price"/>
        </service>

        <service id="processor.product.link" class="TechDivision\Import\Product\Services\ProductLinkProcessor">
            <argument type="service" id="connection"/>
            <argument type="service" id="repository.product.link"/>
            <argument type="service" id="repository.product.link.attribute.int"/>
            <argument type="service" id="action.product.link"/>
            <argument type="service" id="action.product.link.attribute.int"/>
        </service>

        <service id="processor.product.media" class="TechDivision\Import\Product\Services\ProductMediaProcessor">
            <argument type="service" id="connection"/>
            <argument type="service" id="repository.product.media.gallery"/>
            <argument type="service" id="repository.product.media.gallery.value"/>
            <argument type="service" id="repository.product.media.gallery.value.to.entity"/>
            <argument type="service" id="action.product.media.gallery"/>
            <argument type="service" id="action.product.media.gallery.value"/>
            <argument type="service" id="action.product.media.gallery.value.to.entity"/>
            <argument type="service" id="action.product.media.gallery.value.video"/>
        </service>

        <service id="processor.product.variant" class="TechDivision\Import\Product\Services\ProductVariantProcessor">
            <argument type="service" id="connection"/>
            <argument type="service" id="repository.eav.attribute.option.value"/>
            <argument type="service" id="repository.eav.attribute"/>
            <argument type="service" id="repository.product.relation"/>
            <argument type="service" id="repository.product.super.link"/>
            <argument type="service" id="repository.product.super.attribute"/>
            <argument type="service" id="repository.product.super.attribute.label"/>
            <argument type="service" id="action.product.relation"/>
            <argument type="service" id="action.product.super.link"/>
            <argument type="service" id="action.product.super.attribute"/>
            <argument type="service" id="action.product.super.attribute.label"/>
        </service>

        <service id="application" class="TechDivision\Import\Cli\Application">
            <argument type="service" id="container"/>
            <call method="add">
                <argument type="service" id="command.import.products"/>
            </call>
            <call method="add">
                <argument type="service" id="command.import.categories"/>
            </call>
            <call method="add">
                <argument type="service" id="command.import.clear.pid"/>
            </call>
        </service>
        
        <service id="simple" class="TechDivision\Import\Cli\Simple">
            <argument type="service" id="container"/>
            <argument type="service" id="processor.registry"/>
            <argument type="service" id="processor.import"/>
            <argument type="service" id="configuration"/>
            <argument type="service" id="output"/>
            <argument type="service" id="loggers"/>
        </service>
        
    </services>

</container>